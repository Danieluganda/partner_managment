<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css"> <!-- assuming standard css exists -->
    <style>
        .preview-table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; font-size: 0.9rem; }
        .preview-table th, .preview-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .preview-table th { background-color: #f4f4f4; }
        .sheet-section { margin-bottom: 3rem; background: #fff; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; background: #eee; }
        .badge-deliverables { background: #e3f2fd; color: #0d47a1; }
        .badge-personnel { background: #e8f5e9; color: #1b5e20; }
        .badge-partners { background: #fff3e0; color: #e65100; }
        .actions { margin-top: 2rem; padding: 1rem; background: #f9f9f9; text-align: center; }
        .btn { padding: 10px 20px; text-decoration: none; border-radius: 4px; cursor: pointer; border: none; font-size: 1rem; }
        .btn-primary { background: #007bff; color: white; }
        .btn-secondary { background: #6c757d; color: white; margin-right: 1rem; }
    </style>
</head>
<body>
    <div style="max-width: 1200px; margin: 0 auto; padding: 2rem;">
        <h1>Preview Import: <%= filename %></h1>
        <p>Review the data below. Only the first 5 rows of each sheet are shown.</p>

        <form action="/excel/confirm" method="POST">
            <input type="hidden" name="uploadedPath" value="<%= uploadedPath %>">

            <% data.sheets.forEach(function(sheet, idx) { %>
                <div class="sheet-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h2>
                            <label>
                                <input type="checkbox" name="sheetsToImport" value="<%= sheet.name %>" checked>
                                Sheet: <%= sheet.name %>
                            </label>
                        </h2>
                        <span class="badge badge-<%= sheet.type %>">Type: <%= sheet.type %></span>
                        <span>Total Rows: <%= sheet.totalRows %></span>
                    </div>

                    <% if (sheet.totalRows === 0) { %>
                        <p><em>Empty sheet</em></p>
                    <% } else { %>
                        <div style="overflow-x: auto;">
                            <table class="preview-table">
                                <thead>
                                    <tr>
                                        <% sheet.header.forEach(function(col) { %>
                                            <th><%= col %></th>
                                        <% }); %>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% sheet.preview.forEach(function(row) { %>
                                        <tr>
                                            <% sheet.header.forEach(function(col) { %>
                                                <td><%= row[col] !== null ? row[col] : '' %></td>
                                            <% }); %>
                                        </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        </div>
                        <% if (sheet.totalRows > 5) { %>
                            <p style="text-align: center; color: #666;">... and <%= sheet.totalRows - 5 %> more rows</p>
                        <% } %>
                    <% } %>
                </div>
            <% }); %>

            <div class="actions">
                <a href="/excel/upload-form" class="btn btn-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary">Confirm Import & Save</button>
            </div>
        </form>
    </div>
</body>
</html>
